<!--
  通用分页组件 - 带页码选择
  用法：
    <th:block th:replace="~{modules/pagination :: pagination(data=${posts}, urlPattern='/page/{page}', firstPageUrl='/')}" />
    
  参数：
    - data: 分页数据 (需要 page, totalPages, hasPrevious, hasNext)
    - urlPattern: URL 模式，{page} 会被替换为页码 (可选，默认使用 data.prevUrl/nextUrl)
    - firstPageUrl: 第一页的 URL (可选，默认 urlPattern 中 {page}=1)
-->

<!-- 标准版本：使用 data.prevUrl / data.nextUrl -->
<th:block th:fragment="pagination(data)">
  <nav class="pagination-wrapper" th:if="${data.totalPages > 1}">
    <div class="pagination">
      <!-- 上一页 -->
      <a th:if="${data.hasPrevious}" th:href="${data.prevUrl}" class="page-btn page-prev">
        <span class="icon-[ph--caret-left-bold]"></span>
      </a>
      <span th:unless="${data.hasPrevious}" class="page-btn page-prev disabled">
        <span class="icon-[ph--caret-left-bold]"></span>
      </span>

      <!-- 页码：简洁版 当前/总数 -->
      <span class="page-info">
        <span class="page-current" th:text="${data.page}"></span>
        <span class="page-sep">/</span>
        <span class="page-total" th:text="${data.totalPages}"></span>
      </span>

      <!-- 下一页 -->
      <a th:if="${data.hasNext}" th:href="${data.nextUrl}" class="page-btn page-next">
        <span class="icon-[ph--caret-right-bold]"></span>
      </a>
      <span th:unless="${data.hasNext}" class="page-btn page-next disabled">
        <span class="icon-[ph--caret-right-bold]"></span>
      </span>

      <!-- 页码输入跳转 -->
      <th:block th:replace="~{modules/page-jump :: pageJump(data=${data})}" />
    </div>
  </nav>
</th:block>

<!-- 首页专用版本：自定义 URL -->
<th:block th:fragment="paginationIndex(data)">
  <nav class="pagination-wrapper" th:if="${data.totalPages > 1}">
    <div class="pagination">
      <!-- 上一页 -->
      <a
        th:if="${data.hasPrevious}"
        th:href="${data.page == 2 ? '/' : '/page/' + (data.page - 1)}"
        class="page-btn page-prev"
      >
        <span class="icon-[ph--caret-left-bold]"></span>
      </a>
      <span th:unless="${data.hasPrevious}" class="page-btn page-prev disabled">
        <span class="icon-[ph--caret-left-bold]"></span>
      </span>

      <!-- 页码列表 -->
      <div class="page-numbers">
        <!-- 第一页 -->
        <a th:if="${data.page > 2}" href="/" class="page-num">1</a>
        <span th:if="${data.page > 3}" class="page-ellipsis">...</span>

        <!-- 当前页前一页 -->
        <a
          th:if="${data.page > 1}"
          th:href="${data.page == 2 ? '/' : '/page/' + (data.page - 1)}"
          class="page-num"
          th:text="${data.page - 1}"
        ></a>

        <!-- 当前页 -->
        <span class="page-num active" th:text="${data.page}"></span>

        <!-- 当前页后一页 -->
        <a
          th:if="${data.page < data.totalPages}"
          th:href="${'/page/' + (data.page + 1)}"
          class="page-num"
          th:text="${data.page + 1}"
        ></a>

        <!-- 最后一页 -->
        <span th:if="${data.page < data.totalPages - 2}" class="page-ellipsis">...</span>
        <a
          th:if="${data.page < data.totalPages - 1}"
          th:href="${'/page/' + data.totalPages}"
          class="page-num"
          th:text="${data.totalPages}"
        ></a>
      </div>

      <!-- 下一页 -->
      <a th:if="${data.hasNext}" th:href="${'/page/' + (data.page + 1)}" class="page-btn page-next">
        <span class="icon-[ph--caret-right-bold]"></span>
      </a>
      <span th:unless="${data.hasNext}" class="page-btn page-next disabled">
        <span class="icon-[ph--caret-right-bold]"></span>
      </span>

      <!-- 页码输入跳转 -->
      <th:block
        th:replace="~{modules/page-jump :: pageJumpWithPattern(data=${data}, urlPattern='/page/{page}', firstPageUrl='/')}"
      />
    </div>
  </nav>
</th:block>

<!-- 通用页码版本：需要传入 urlPattern -->
<th:block th:fragment="paginationWithNumbers(data, urlPattern, firstPageUrl)">
  <nav
    class="pagination-wrapper"
    th:if="${data.totalPages > 1}"
    th:with="firstUrl=${firstPageUrl != null ? firstPageUrl : #strings.replace(urlPattern, '{page}', '1')}"
  >
    <div class="pagination">
      <!-- 上一页 -->
      <a
        th:if="${data.hasPrevious}"
        th:href="${data.page == 2 ? firstUrl : #strings.replace(urlPattern, '{page}', '' + (data.page - 1))}"
        class="page-btn page-prev"
      >
        <span class="icon-[ph--caret-left-bold]"></span>
      </a>
      <span th:unless="${data.hasPrevious}" class="page-btn page-prev disabled">
        <span class="icon-[ph--caret-left-bold]"></span>
      </span>

      <!-- 页码列表 -->
      <div class="page-numbers">
        <!-- 第一页 -->
        <a th:if="${data.page > 2}" th:href="${firstUrl}" class="page-num">1</a>
        <span th:if="${data.page > 3}" class="page-ellipsis">...</span>

        <!-- 当前页前一页 -->
        <a
          th:if="${data.page > 1}"
          th:href="${data.page == 2 ? firstUrl : #strings.replace(urlPattern, '{page}', '' + (data.page - 1))}"
          class="page-num"
          th:text="${data.page - 1}"
        ></a>

        <!-- 当前页 -->
        <span class="page-num active" th:text="${data.page}"></span>

        <!-- 当前页后一页 -->
        <a
          th:if="${data.page < data.totalPages}"
          th:href="${#strings.replace(urlPattern, '{page}', '' + (data.page + 1))}"
          class="page-num"
          th:text="${data.page + 1}"
        ></a>

        <!-- 最后一页 -->
        <span th:if="${data.page < data.totalPages - 2}" class="page-ellipsis">...</span>
        <a
          th:if="${data.page < data.totalPages - 1}"
          th:href="${#strings.replace(urlPattern, '{page}', '' + data.totalPages)}"
          class="page-num"
          th:text="${data.totalPages}"
        ></a>
      </div>

      <!-- 下一页 -->
      <a
        th:if="${data.hasNext}"
        th:href="${#strings.replace(urlPattern, '{page}', '' + (data.page + 1))}"
        class="page-btn page-next"
      >
        <span class="icon-[ph--caret-right-bold]"></span>
      </a>
      <span th:unless="${data.hasNext}" class="page-btn page-next disabled">
        <span class="icon-[ph--caret-right-bold]"></span>
      </span>

      <!-- 页码输入跳转 -->
      <th:block
        th:replace="~{modules/page-jump :: pageJumpWithPattern(data=${data}, urlPattern=${urlPattern}, firstPageUrl=${firstUrl})}"
      />
    </div>
  </nav>
</th:block>
